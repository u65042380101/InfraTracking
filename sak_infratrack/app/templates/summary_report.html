{% extends "base.html" %} {% block content %}
<button
  onclick="window.print()"
  class="bg-white border border-gray-300 px-4 py-2 rounded-lg shadow text-gray-700 hover:bg-gray-100 float-right mb-4 print:hidden"
>
  พิมพ์ / บันทึกเป็น PDF
</button>
<h1 class="text-xl font-bold mb-2">รายงานสรุปการแก้ไขปัญหา</h1>
<p class="text-gray-500 mb-6">ออกรายงานวันที่ {{ today|date:"d/m/Y" }}</p>
<!-- Section Template -->
<div class="mb-6 border rounded-xl p-4 bg-white shadow">
  <div class="font-bold text-gray-700 mb-3">
    1) สรุปจำนวนปัญหาที่แก้ไข (ตามเดือน)
  </div>
  <table
    class="min-w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"
  >
    <thead class="bg-gray-100">
      <tr>
        <th
          class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-700"
        >
          เดือน
        </th>
        <th
          class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700"
        >
          จำนวนรายการ
        </th>
        <th
          class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700"
        >
          ผู้บันทึก
        </th>
      </tr>
    </thead>
    <tbody>
      {% for row in month_summary %}
      <tr class="hover:bg-gray-50">
        <td class="border border-gray-300 px-4 py-2">{{ row.month }}</td>
        <td class="border border-gray-300 px-4 py-2 text-center">
          {{ row.count }}
        </td>
        <td class="border border-gray-300 px-4 py-2 text-center">
          {{ row.bys|join:", " }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<div class="mb-6 border rounded-xl p-4 bg-white shadow">
  <div class="font-bold text-gray-700 mb-3">
    2) สรุปปัญหาที่แก้ไข (รวมทั้งปี)
  </div>
  <table
    class="min-w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"
  >
    <thead class="bg-gray-100">
      <tr>
        <th class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-700">ประเภทอุปกรณ์</th>
        <th class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700">จำนวนรายการ</th>
        <th class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700">ผู้บันทึก</th>
      </tr>
    </thead>
    <tbody>
      {% for row in device_summary %}
      <tr class="hover:bg-gray-50">
        <td class="border border-gray-300 px-4 py-2">{{ row.device }}</td>
        <td class="border border-gray-300 px-4 py-2 text-center">{{ row.count }}</td>
        <td class="border border-gray-300 px-4 py-2 text-center">
          {{ row.bys|join:", " }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<div class="mb-6 border rounded-xl p-4 bg-white shadow">
  <div class="font-bold text-gray-700 mb-3">
    3) สรุปปัญหาที่แก้ไข (เดือนพฤษภาคม)
  </div>
  <table
    class="min-w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"
  >
    <thead class="bg-gray-100">
      <tr>
        <th class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-700">ประเภทอุปกรณ์</th>
        <th class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700">จำนวนรายการ</th>
        <th class="border border-gray-300 px-4 py-2 text-center font-semibold text-gray-700">ผู้บันทึก</th>
      </tr>
    </thead>
    <tbody>
      {% for row in may_summary %}
      <tr class="hover:bg-gray-50">
        <td class="border border-gray-300 px-4 py-2">{{ row.device }}</td>
        <td class="border border-gray-300 px-4 py-2 text-center">{{ row.count }}</td>
        <td class="border border-gray-300 px-4 py-2 text-center">
          {{ row.bys|join:", " }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
